<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title> PRESET - Estoque</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="style.css" />
  <!-- Estilos isolados apenas para a página "Solicitar item" -->
  <link rel="stylesheet" href="solicitar.css" />
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#043058"><!--adicionado essas 3 linhas do meta name para não dar erro no safari-->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <link rel="apple-touch-icon" href="icons/icon-192.png">

</head>
<body>
  <div class="app-container">
    <header class="app-header">
      <h1>PRESET</h1>
    </header>

    <!-- TELA 1 - LOGIN -->
    <main id="page-login" class="page active">
      <div class="login-box">
        <div class="form-group">
          <label for="input-nome">Nome do usuário</label>
          <input type="text" id="input-nome" placeholder="Nome e sobrenome" />
        </div>

        <div class="form-group">
          <label for="input-setor">Setor</label>
          <select id="input-setor">
            <option value="">Selecione o setor</option>
            <option value="Almoxarifado">Almoxarifado</option>
            <option value="Eng de Processo">Eng de Processo</option>
            <option value="Eng de Produto">Eng de Produto</option>
            <option value="Ferramentaria">Ferramentaria</option>
            <option value="Manutenção">Manuteção</option>
            <option value="Metrologia">Metrologia</option>
            <option value="Presset">Preset</option>
            <option value="Qualidade">Qualidade</option>
            <option value="Torno">Torno</option>
            <option value="Usinagem">Usinagem</option> 
          </select>
        </div>

        <div class="form-group">
          <label for="input-turno">Turno</label>
          <select id="input-turno">
            <option value="">Selecione o turno</option>
            <option value="1º Turno">1º Turno</option>
            <option value="2º Turno">2º Turno</option>
            <option value="3º Turno">3º Turno</option>
            <option value="Comercial">Comercial</option>
          </select>
        </div>

        <div class="form-group">
          <label for="input-senha">Senha</label>
          <input type="password" id="input-senha" placeholder="Digite sua senha" />
        </div>

        <button id="btn-login" class="primary-btn">Entrar</button>
        <button id="btn-criar-conta" class="secondary-btn">Criar conta</button>

        <small class="help-text">
            Apenas administradores conseguem ver o botão <strong>Abastecer estoque</strong>.
          </small>

      </div>
    </main>

    <!-- TELA 2 - MENU PRINCIPAL DE ESTOQUE -->
    <main id="page-home" class="page">
      <div class="top-bar-home">
        <div class="user-info">
          <span id="user-name-text"></span>
          <small id="user-extra-text"></small>
        </div>
        <button id="btn-logout" class="logout-btn">Sair</button>
      </div>

      <p class="section-title">Selecione uma categoria</p>

      <div class="buttons-grid">
        <button class="main-btn" data-target="page-parafusos">Parafusos</button>
        <button class="main-btn" data-target="page-conexoes">Conexões</button>
        <button class="main-btn" data-target="page-ferramentas">Ferramentas</button>
        <button class="main-btn" data-target="page-filtros">Filtros</button>
        <!-- Solicitar item (abre a página de solicitação) -->
        <button id="btn-solicitar-item" class="action-btn btn-abrir-solicitar" type="button" data-target="page-solicitar-item">
          Solicitar item
        </button>
      </div>

      <button id="btn-abastecer" class="secondary-btn" style="display:none;">
        Abastecer estoque
      </button>

      <button id="btn-admins" class="secondary-btn" style="display:none; margin-top: 8px;">
        Gerenciar administradores
      </button>
      <button id="btn-retiradas" class="secondary-btn" style="display:none; margin-top: 8px;">
        Retiradas
      </button>

      <button id="btn-solicitacoes" class="secondary-btn" style="display:none; margin-top: 8px;">
        Solicitações
      </button>

    </main>

    <!-- TELA - ABASTECER ESTOQUE (SÓ ADMIN/MASTER) -->
    <main id="page-abastecer" class="page">
      <div class="top-bar">
        <button class="back-btn" data-target="page-home">◀</button>
        <h2>Abastecer estoque</h2>
      </div>
      <p class="info-text">
        Informe as quantidades para <strong>abastecer</strong> o estoque. Os valores serão somados ao saldo atual.
      </p>
      <div id="abastecer-container"></div>
      <button id="btn-salvar-abastecimento" class="action-btn">
        Salvar abastecimento
      </button>
    </main>

    <!-- TELA - PARAFUSOS -->
    <main id="page-parafusos" class="page">
      <div class="top-bar">
        <button class="back-btn" data-target="page-home">◀</button>
        <h2>Parafusos</h2>
      </div>
      <div class="items-list" data-category="parafusos"></div>
      <button class="action-btn" data-category="parafusos">Retirar</button>
    </main>

    <!-- TELA - CONEXÕES -->
    <main id="page-conexoes" class="page">
      <div class="top-bar">
        <button class="back-btn" data-target="page-home">◀</button>
        <h2>Conexões</h2>
      </div>
      <div class="items-list" data-category="conexoes"></div>
      <button class="action-btn" data-category="conexoes">Retirar</button>
    </main>

    <!-- TELA - FERRAMENTAS -->
    <main id="page-ferramentas" class="page">
      <div class="top-bar">
        <button class="back-btn" data-target="page-home">◀</button>
        <h2>Ferramentas</h2>
      </div>
      <div class="items-list" data-category="ferramentas"></div>
      <button class="action-btn" data-category="ferramentas">Retirar</button>
    </main>

    <!-- TELA - FILTROS -->
    <main id="page-filtros" class="page">
      <div class="top-bar">
        <button class="back-btn" data-target="page-home">◀</button>
        <h2>Filtros</h2>
      </div>
      <div class="items-list" data-category="filtros"></div>
      <button class="action-btn" data-category="filtros">Retirar</button>
    </main>

    <!-- TELA - GERENCIAMENTO DE ADMINS (SÓ MASTER) -->
    <main id="page-admins" class="page">
      <div class="top-bar">
        <button class="back-btn" data-target="page-home">◀</button>
        <h2>Administradores</h2>
      </div>

      <div class="admin-section">
        <h3>Cadastrar novo administrador</h3>
        <div class="form-group">
          <label for="admin-nome">Nome do admin</label>
          <input type="text" id="admin-nome" placeholder="Ex: João" />
        </div>
        <div class="form-group">
          <label for="admin-senha">Senha do admin</label>
          <input type="password" id="admin-senha" placeholder="Senha" />
        </div>
        <button id="btn-add-admin" class="primary-btn">Cadastrar admin</button>
      </div>

      <div class="admin-section">
        <h3>Admins cadastrados</h3>
        <ul id="admin-list" class="admin-list"></ul>
        <small class="help-text">
          Apenas o usuário MASTER consegue ver e editar esta tela.
        </small>
      </div>
      
    </main>
    <!-- TELA - RETIRADAS (SÓ ADMIN/MASTER) -->
    <main id="page-retiradas" class="page">
      <div class="page-header">
        <button class="back-btn" data-target="page-home">◀</button>
        <h2>Retiradas</h2>
      </div>

      <div class="withdrawals-controls">
        <button id="btn-export-retiradas" class="secondary-btn">Exportar Excel</button>
        <button id="btn-refresh-retiradas" class="secondary-btn">Atualizar</button>
      </div>

      <div id="withdrawals-empty" class="muted-text" style="display:none; margin-top: 10px;">
        Nenhuma retirada encontrada.
      </div>

      <div class="withdrawals-table-wrap">
        <table class="withdrawals-table">
          <thead>
            <tr>
              <th>Data</th>
              <th>Usuário</th>
              <th>Setor</th>
              <th>Item</th>
              <th>Qtd</th>
            </tr>
          </thead>
          <tbody id="withdrawals-tbody"></tbody>
        </table>
      </div>
    </main>

    <!-- TELA - SOLICITAR ITEM (USUÁRIO) -->
    <main id="page-solicitar-item" class="page">
      <div class="top-bar">
        <button class="back-btn" data-target="page-home">◀</button>
        <h2>Solicitar item</h2>
      </div>

      <div class="login-box">
        <div class="form-group">
          <label for="req-nome">Nome</label>
          <input type="text" id="req-nome" placeholder="Seu nome" />
        </div>

        <div class="form-group">
          <label for="req-setor">Setor</label>
          <input type="text" id="req-setor" placeholder="Seu setor" />
        </div>

        <div class="form-group">
          <label for="req-turno">Turno</label>
          <input type="text" id="req-turno" placeholder="Seu turno" />
        </div>

        <div class="form-group">
          <label for="req-supervisor">Supervisor responsável</label>
          <input type="text" id="req-supervisor" placeholder="Nome do supervisor" />
        </div>

        <div class="form-group">
          <label for="req-item">Item a ser solicitado Ex: Ferramentas, Parafusos...</label>
          <input type="text" id="req-item" placeholder="Descreva o item" />
        </div>

        <div class="form-group">
          <label for="req-data">Data</label>
          <input type="text" id="req-data" readonly />
        </div>

        <button id="btn-enviar-solicitacao" class="action-btn btn-solicitar">Solicitar</button>
      </div>
    </main>

    <!-- TELA - SOLICITAÇÕES (SÓ ADMIN/MASTER) -->
    <main id="page-solicitacoes" class="page">
      <div class="page-header">
        <button class="back-btn" data-target="page-home">◀</button>
        <h2>Solicitações</h2>
      </div>

      <div class="withdrawals-controls">
        <button id="btn-export-solicitacoes" class="secondary-btn">Exportar Excel</button>
        <button id="btn-refresh-solicitacoes" class="secondary-btn">Atualizar</button>
      </div>

      <div id="solicitacoes-empty" class="muted-text" style="display:none; margin-top: 10px;">
        Nenhuma solicitação encontrada.
      </div>

      <div class="withdrawals-table-wrap">
        <table class="withdrawals-table">
          <thead>
            <tr>
              <th>Data</th>
              <th>Usuário</th>
              <th>Setor</th>
              <th>Turno</th>
              <th>Supervisor</th>
              <th>Item</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody id="solicitacoes-tbody"></tbody>
        </table>
      </div>
    </main>


    <div id="toast" class="toast"></div>
  </div>

  <!-- Firebase SDKs (CDN) -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

  <!-- Seu app -->
  <script src="app.js?v=4"></script>
  <script>
  if ("serviceWorker" in navigator) {
    const isLocal = location.hostname === "localhost" || location.hostname === "127.0.0.1";

    window.addEventListener("load", () => {
      if (!isLocal) {
        navigator.serviceWorker.register("service-worker.js");
      }
    });
  }
</script>

</body>
</html>
